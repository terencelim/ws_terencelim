function formatDate(t){t=new Date(t),t=dayName[t.getDay()]+" "+("0"+t.getDate()).slice(-2)+" "+monthName[t.getMonth()]+" "+t.getFullYear();return t}function formatInputFormDate(t){return t.getFullYear().toString()+"-"+("0"+(t.getMonth()+1)).toString().slice(-2)+"-"+("0"+t.getDate()).toString().slice(-2)}function getRiskLevel(e){var n=0;return alertLevels.forEach(t=>{e.trim().toLowerCase()==t.alert.trim().toLowerCase()&&(n=t.risk)}),n}function findInfo(t){for(var e="",n=0,a=document.getElementById("suburb").value,o=new RegExp(a.trim(),"i"),r=0;r<t.length;r++)0<=t[r].Suburb.trim().search(o)&&(e+=genTable(t[r],r),n+=1);document.getElementById("id04").innerHTML=n,document.getElementById("id02").innerHTML=tableHead+e+tableFoot}function genTable(t,e){var n=tableBody.replace("{{suburb}}",t.Suburb),n=n.replace("{{venue}}",t.Venue);return n=n.replace("{{address}}",t.Address),n=n.replace("{{date}}",checkParseMultiDateString(t.Date)),n=n.replace("{{time}}",t.Time),n=n.replace("{{lastupdate}}",formatDate(t["Last updated date"])),n=n.replaceAll("{{alert}}",getRiskLevel(t.Alert)),n=n.replaceAll("{{advice}}",e),n}function checkDate(t){var e,n=jsonObject.data.monitor,a=document.getElementById("suburb"),o=document.getElementById("date"),r="",l=0,u=new Date(todaysDate.getFullYear(),todaysDate.getMonth(),todaysDate.getDate()+t),i=new Date(o.value),d=new Date(i.getFullYear(),i.getMonth(),i.getDate());if(a.value="",t<0){for(o.value=formatInputFormDate(u),e=0;e<n.length;e++){var c=new Date(n[e].Date),s=new Date(c.getFullYear(),c.getMonth(),c.getDate());u<=s&&(r+=genTable(n[e],e),l+=1)}document.getElementById("id05").innerHTML=l,document.getElementById("id02").innerHTML=tableHead+r+tableFoot}if(0==t)if(todaysDateOnly<=d)checkSuburb();else{for(e=0;e<n.length;e++){c=new Date(n[e].Date),s=new Date(c.getFullYear(),c.getMonth(),c.getDate());d<=s&&s<=d&&(r+=genTable(n[e],e),l+=1)}document.getElementById("id05").innerHTML=l,document.getElementById("id02").innerHTML=tableHead+r+tableFoot}}function checkSuburb(){var t=jsonObject.data.monitor;findInfo(t)}function checkParseMultiDateString(t){var e,n=t.match(/\d{4}/gi),a=t;if(null==n)a=t+" 2021",console.log(a," | ",t);else if(1<n.length){if(null!=t.match(/to(?=\s)/gi))return e=t.split("to"),formatDate(e[0].trim())+" to "+formatDate(e[1].trim());if(null!=t.match(/\-(?=\s)/gi))return e=t.split("-"),formatDate(e[0].trim())+" to "+formatDate(e[1].trim())}return formatDate(a)}function singleDateValidate(t){var e=t.match(/\d{4}/gi),n=null;return null==e?(n=t+" 2021",console.log(n," | ",t)):(1<e.length&&(n=t.search(/\d{4}/gi),n=t.substr(0,n+4).trim()),1==e.length&&(n=t.trim())),new Date(n)}function rankingSorter(o,r){return function(t,e){var n=singleDateValidate(t[o]),a=singleDateValidate(e[o]),n=n.getTime().toString(),a=a.getTime().toString();return a<n?-1:n<a||t[r]>e[r]?1:t[r]<e[r]?-1:0}}function loadJSON(t){jsonObject=JSON.parse(t);t=jsonObject.data.monitor;t.sort(rankingSorter("Date","Venue")),document.getElementById("id01").innerHTML=jsonObject.date,document.getElementById("id03").innerHTML=t.length,findInfo(t)}function devLoadJSON(){var t=jsonObject.data.monitor;document.getElementById("id01").innerHTML=jsonObject.date,document.getElementById("id03").innerHTML=t.length,findInfo(t)}function getLatestUrlJSON(t){var e,t=JSON.parse(t),t=t.result.resources;t.forEach(t=>{"json"==t.format.trim().toLowerCase()&&(e=t.url)}),loadData(e,loadJSON)}function loadData(t,e){var n=new XMLHttpRequest,a=!0;n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(e(this.responseText),responseSuccess=!0)},n.open("GET",t,a),n.send()}function getData(){var t="https://data.nsw.gov.au/data/api/3/action/package_show?id=0a52e6c1-bc0b-48af-8b45-d791a6d8e289";loadData(t,getLatestUrlJSON)}function loadSuburbButtons(){Object.keys(suburbList).length;for(var n in suburbList)suburbList[n].forEach(t=>{var e=Object.keys(suburbList).indexOf(n),e=e+1<=btnColor.length?btnColor[e]:"btn-secondary";createButton(t,e)})}function createButton(t,e){let n=document.createElement("button");var a=document.getElementById("suburbList");n.innerHTML=t.trim(),n.setAttribute("class","btn btn-suburb "+e),n.setAttribute("onclick","javascript:document.getElementById('suburb').value=this.innerHTML;document.getElementById('id05').innerHTML='0';document.getElementById('date').value='';checkSuburb();"),a.appendChild(n)}function scrollFunction(){20<document.body.scrollTop||20<document.documentElement.scrollTop?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}var jsonURL,jsonObject,responseSuccess=!1,todaysDate=new Date(Date.now()),todaysDateOnly=new Date(todaysDate.getFullYear(),todaysDate.getMonth(),todaysDate.getDate()),todaysDateFormatted=formatInputFormDate(todaysDate);loadSuburbButtons(),document.getElementById("date").value=todaysDateFormatted,getData();var mybutton=document.getElementById("btnTop");window.onscroll=function(){scrollFunction()};