function formatDate(e){e=new Date(e),e=dayName[e.getDay()]+" "+("0"+e.getDate()).slice(-2)+" "+monthName[e.getMonth()]+" "+e.getFullYear();return e}function formatDateTime(e){e=new Date(e),e=e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2);return e}function formatInputFormDate(e){return e.getFullYear().toString()+"-"+("0"+(e.getMonth()+1)).toString().slice(-2)+"-"+("0"+e.getDate()).toString().slice(-2)}function getRiskLevel(t){var n=0;return alertLevels.forEach(e=>{t.trim().toLowerCase().includes(e.alert.trim().toLowerCase())&&(n=e.risk)}),n}function findInfo(e){for(var t="",n=0,a=document.getElementById("suburb").value,o=new RegExp(a.trim(),"i"),r=0;r<e.length;r++)0<=e[r].Suburb.trim().search(o)&&(t+=genTable(e[r],r),n+=1);document.getElementById("id04").innerHTML=n,document.getElementById("id02").innerHTML=tableHead+t+tableFoot}function genTable(e,t){var n=tableBody.replace(/{{suburb}}/g,e.Suburb),n=n.replace("{{lat}}",e.Lat);return n=n.replace("{{lon}}",e.Lon),n=n.replace("{{venue}}",e.Venue),n=n.replace("{{address}}",e.Address),n=n.replace("{{date}}",checkParseMultiDateString(e.Date)),n=n.replace("{{time}}",e.Time),n=n.replace("{{lastupdate}}",formatDate(e["Last updated date"])),n=n.replaceAll("{{alert}}",getRiskLevel(e.Alert)),n=n.replaceAll("{{advice}}",t),n}function checkDate(e){var t,n=jsonObject.data.monitor,a=document.getElementById("suburb"),o=document.getElementById("date"),r="",l=0,i=new Date(todaysDate.getFullYear(),todaysDate.getMonth(),todaysDate.getDate()+e),u=new Date(o.value),d=new Date(u.getFullYear(),u.getMonth(),u.getDate());if(a.value="",e<0){for(o.value=formatInputFormDate(i),t=0;t<n.length;t++){var s=new Date(n[t].Date),c=new Date(s.getFullYear(),s.getMonth(),s.getDate());i<=c&&(r+=genTable(n[t],t),l+=1)}document.getElementById("id05").innerHTML=l,document.getElementById("id02").innerHTML=tableHead+r+tableFoot}if(0==e)if(todaysDateOnly<=d)checkSuburb();else{for(t=0;t<n.length;t++){s=new Date(n[t].Date),c=new Date(s.getFullYear(),s.getMonth(),s.getDate());d<=c&&c<=d&&(r+=genTable(n[t],t),l+=1)}document.getElementById("id05").innerHTML=l,document.getElementById("id02").innerHTML=tableHead+r+tableFoot}}function checkSuburb(){var e=jsonObject.data.monitor;findInfo(e)}function checkParseMultiDateString(e){var t,n=e.match(/\d{4}/gi),a=e;if(null==n)a=e+" 2021";else if(1<n.length){if(null!=e.match(/to(?=\s)/gi))return t=e.split("to"),formatDate(t[0].trim())+" to "+formatDate(t[1].trim());if(null!=e.match(/\-(?=\s)/gi))return t=e.split("-"),formatDate(t[0].trim())+" to "+formatDate(t[1].trim())}return formatDate(a)}function singleDateValidate(e){var t=e.match(/\d{4}/gi),n=null;return null==t?n=e+" 2021":(1<t.length&&(n=e.search(/\d{4}/gi),n=e.substr(0,n+4).trim()),1==t.length&&(n=e.trim())),new Date(n)}function rankingSorter(o,r){return function(e,t){var n=singleDateValidate(e[o]),a=singleDateValidate(t[o]),n=n.getTime().toString(),a=a.getTime().toString();return a<n?-1:n<a||e[r]>t[r]?1:e[r]<t[r]?-1:0}}function loadJSON(e){jsonObject=JSON.parse(e);e=jsonObject.data.monitor;e.sort(rankingSorter("Date","Venue")),document.getElementById("id01").innerHTML=jsonObject.date,document.getElementById("id03").innerHTML=e.length,document.getElementById("id06").innerHTML=formatDateTime(new Date),findInfo(e)}function devLoadJSON(){var e=jsonObject.data.monitor;document.getElementById("id01").innerHTML=jsonObject.date,document.getElementById("id03").innerHTML=e.length,findInfo(e)}function getLatestUrlJSON(e){var t,e=JSON.parse(e),e=e.result.resources;e.forEach(e=>{"json"==e.format.trim().toLowerCase()&&(t=e.url)}),loadData(t,loadJSON)}function loadData(e,t){var n=new XMLHttpRequest,a=!0;n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(t(this.responseText),responseSuccess=!0)},n.open("GET",e,a),n.send()}function getData(){var e=document.getElementById("loadData");const t=e.innerText;e.disabled=!0,e.classList.add("btn-Disable");var n=60,a=setInterval(function(){--n,e.innerText="Disabled for [ "+n.toString()+" ] seconds"},1e3);setTimeout(function(){e.innerText=t,e.disabled=!1,e.classList.remove("btn-Disable"),clearInterval(a)},1e3*n);var o="https://data.nsw.gov.au/data/api/3/action/package_show?id=0a52e6c1-bc0b-48af-8b45-d791a6d8e289";loadData(o,getLatestUrlJSON)}function loadSuburbButtons(){Object.keys(suburbList).length;for(var n in suburbList)suburbList[n].forEach(e=>{var t=Object.keys(suburbList).indexOf(n),t=t+1<=btnColor.length?btnColor[t]:"btn-secondary";createButton(e,t)})}function createButton(e,t){let n=document.createElement("button");var a=document.getElementById("suburbList");n.innerHTML=e.trim(),n.setAttribute("class","btn btn-suburb "+t),n.setAttribute("onclick","javascript:document.getElementById('suburb').value=this.innerHTML;document.getElementById('id05').innerHTML='0';document.getElementById('date').value='';checkSuburb();"),a.appendChild(n)}function scrollFunction(){20<document.body.scrollTop||20<document.documentElement.scrollTop?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}var jsonURL,jsonObject,responseSuccess=!1,todaysDate=new Date(Date.now()),todaysDateOnly=new Date(todaysDate.getFullYear(),todaysDate.getMonth(),todaysDate.getDate()),todaysDateFormatted=formatInputFormDate(todaysDate);loadSuburbButtons(),document.getElementById("date").value=todaysDateFormatted,getData();var mybutton=document.getElementById("btnTop");window.onscroll=function(){scrollFunction()};