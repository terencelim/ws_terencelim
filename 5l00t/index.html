<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="./favicon.ico">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Tool Listing</title>
  </head>
  <body>
    <div class="container">
        <h1>Tool Listing</h1>
        <!-- <section id="app"> -->
            <!-- loading... -->
        <!-- </section> -->
        <ul id="myList">
        </ul>
        
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    -->

    <script>
        // https://stackoverflow.com/questions/7346563/loading-local-json-file
        // required use of an anonymous callback,
        // as .open() will NOT return a value but simply returns undefined in asynchronous mode!

        const loadJSON = (callback) => {
            const xObj = new XMLHttpRequest();
            xObj.overrideMimeType("application/json");
            // 1. replace './data.json' with the local path of your file
            xObj.open('GET', './data.json', true);
            xObj.onreadystatechange = () => {
                if (xObj.readyState === 4 && xObj.status === 200) {
                    // 2. call your callback function
                    callback(xObj.responseText);
                }
            };
            xObj.send(null);
        }

        const init = () => {
            loadJSON((response) => {
                // 3. parse JSON string into JSON Object
                // console.log('response =', response);
                const json = JSON.parse(response);
                // console.log('your local JSON =', JSON.stringify(json, null, 4));
                //// console.log(json.length);
                json.forEach(element => {
                    var node = document.createElement("LI");
                    //// console.log(element);
                    // console.log(element.title);
                    // console.log(element.url);
                    // console.log(element.description);
                    node.appendChild(htmlToElement(`<a href="${element.url}" class="link-primary" target="_blank" style="font-weight: 600;">${element.title}</a>`));
                    document.getElementById("myList").appendChild(node);
                });
                // 4. render to your page
                const app = document.querySelector('#app');
                // app.innerHTML = `<pre>${JSON.stringify(json, null, 4)}</pre>`;
                // initStuff();
            });
        }

        // https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro
        // https://www.w3docs.com/snippets/javascript/how-to-create-a-new-dom-element-from-html-string.html
        /**
         * @param {String} HTML representing a single element
         * @return {Element}
         */
        function htmlToElement(html) {
            var template = document.createElement('template');
            html = html.trim(); // Never return a text node of whitespace as the result
            template.innerHTML = html;
            return template.content.firstChild;
        }

        var hteTD = htmlToElement('<td>foo</td>'),
            hteDIV = htmlToElement('<div><span>nested</span> <span>stuff</span></div>');

        /**
         * @param {String} HTML representing any number of sibling elements
         * @return {NodeList} 
         */
        function htmlToElements(html) {
            var template = document.createElement('template');
            template.innerHTML = html;
            return template.content.childNodes;
        }

        var rows = htmlToElements('<tr><td>foofoo</td></tr><tr><td>barbar</td></tr>');
        
        function initStuff() {
            var div = document.createElement('div');
            div.innerHTML = '<table class="list"><tr><td><a href="xxx">title</a></td></tr></table>';
            // document.body.appendChild(div.firstChild);
            // document.body.appendChild(hteTD);
            // document.body.appendChild(hteDIV);
            const app = document.querySelector('#app');
            app.appendChild(div.firstChild);
            app.appendChild(hteTD);
            app.appendChild(hteDIV);
            // app.appendChild(rows[0]);
            // app.appendChild(rows[1]);
            // app.appendChild(rows[1]);
            //// console.log(rows[0]);
            //// console.log(div.firstChild);
        }
        

        // var node = document.createElement("LI");                 // Create a <li> node
        // var textnode = document.createTextNode("Water");         // Create a text node
        // node.appendChild(textnode);                              // Append the text to <li>
        // document.getElementById("myList").appendChild(node);     // Append <li> to <ul> with id="myList"

        // (function(){
            // init();
        // })();

        init();
        
        // Create Element Nodes
        // ====================
        // function createSvgRect(strBbox) {
        //     var svgns = "http://www.w3.org/2000/svg";
        //     var arrBbox = strBbox.split(" ");
        //     var elmX = arrBbox[1];
        //     var elmY = arrBbox[2];
        //     var elmWidth = arrBbox[3] - arrBbox[1];
        //     var elmHeight = arrBbox[4] - arrBbox[2];
        //     var elmText = arrBbox[0];
        //     var rect = document.createElementNS(svgns, 'rect');
        //     rect.setAttributeNS(null, 'class', 'elmBbox');
        //     rect.setAttributeNS(null, 'x', elmX);
        //     rect.setAttributeNS(null, 'y', elmY);
        //     rect.setAttributeNS(null, 'height', elmHeight);
        //     rect.setAttributeNS(null, 'width', elmWidth);
        //     rect.setAttributeNS(null, 'fill', 'none');
        //     // rect.setAttributeNS(null, 'stroke', '#'+Math.round(0xffffff * Math.random()).toString(16)+'cc');
        //     rect.setAttributeNS(null, 'stroke', '#FF0000FF');
        //     rect.setAttributeNS(null, 'stroke-width', '2');
        //     document.getElementById('svgOne').appendChild(rect);
        // }

        // // Create a new list item when clicking on the "Add" button
        // function newElement() {
        //     var li = document.createElement("li");
        //     var inputValue = document.getElementById("myInput").value;
        //     var t = document.createTextNode(inputValue);
        //     li.setAttribute('draggable', 'true');
        //     li.appendChild(t);
        //     if (inputValue === '') {
        //         alert("You must write something!");
        //     } else {
        //         document.getElementById("myUL").appendChild(li);
        //     }
        //     document.getElementById("myInput").value = "";

        //     var span = document.createElement("SPAN");
        //     var txt = document.createTextNode("\u00D7");
        //     span.className = "close";
        //     span.appendChild(txt);
        //     li.appendChild(span);

        //     for (i = 0; i < close.length; i++) {
        //         close[i].onclick = function () {
        //             var div = this.parentElement;
        //             div.style.display = "none";
        //         }
        //     }
        // }

    </script>
  </body>
</html>
