<!doctype html>
<html lang='en'>

<head>
    <!-- Required meta tags -->
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <!-- Bootstrap CSS -->
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3' crossorigin='anonymous'>

    <title>Sum DateTime to Single Digit</title>
</head>

<body>
    <div class="container">
        <h1>
            Sum DateTime to Single Digit [ <span id="retSingleDigit"></span> ]
            <button type="button" class="btn btn-primary" onclick="initControls()">Today</button>
        </h1>
        <p>
            <span id="retCurrentDateTime"></span>
        </p>
        <hr class="py-0">

        <div class="input-group mb-3">
            <input type="datetime-local" class="form-control" id="dateTimePicker" placeholder="yyyy/mm/dd --:--" aria-label="Date Time Picker" aria-describedby="button-datetime">
            <button class="btn btn-outline-secondary" type="button" id="button-datetime" onclick="updateDatePicker()">Sum</button>
        </div>
        
        <hr class="py-0">

        <div class="mb-3">
            <label for="sliderYear" class="form-label">Year [ <span id="retYear"></span> ] </label>
            <input type="range" class="form-range" value="1900" min="1900" max="2100" id="sliderYear" oninput="updateSliders()">
        </div>
        <div class="mb-3">
            <label for="sliderMonth" class="form-label">Month [ <span id="retMonth"></span> ] </label>
            <input type="range" class="form-range" value="1" min="1" max="12" id="sliderMonth" oninput="updateSliders()">
        </div>
        <div class="mb-3">
            <label for="sliderDay" class="form-label">Day [ <span id="retDay"></span> ] </label>
            <input type="range" class="form-range" value="1" min="1" max="31" id="sliderDay" oninput="updateSliders()">
        </div>

        <div class="mb-3">
            <label for="sliderHour" class="form-label">Hour [ <span id="retHour"></span> ] </label>
            <input type="range" class="form-range" value="0" min="0" max="23" id="sliderHour" oninput="updateSliders()">
        </div>
        <div class="mb-3">
            <label for="sliderMinute" class="form-label">Minute [ <span id="retMinute"></span> ] </label>
            <input type="range" class="form-range" value="0" min="0" max="59" id="sliderMinute" oninput="updateSliders()">
        </div>
        <div class="mb-3">
            <label for="sliderSecond" class="form-label">Second [ <span id="retSecond"></span> ] </label>
            <input type="range" class="form-range" value="0" min="0" max="59" id="sliderSecond" oninput="updateSliders()">
        </div>

    </div>
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js' integrity='sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p' crossorigin='anonymous'></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src='https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js' integrity='sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB' crossorigin='anonymous'></script>
    <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' integrity='sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13' crossorigin='anonymous'></script>
    -->

    <script>

        var iYr, iMth, iDay, iHr, iMin, iSec;

        var getElm = function(idSlider) { return document.getElementById(idSlider); }

        function zeroPad(numToPad, zeroPadLength = 2) {
            return ("0".repeat(zeroPadLength) + numToPad).slice(-zeroPadLength);
        }

        // Main Function
        function sumDateToOneDigit(strDate) {
            do {
            var intSumDate = 0;
            for (var i = 0; i < strDate.length; i++) {
                intSumDate += parseInt(strDate[i]);
            };
            strDate = intSumDate.toString();
            } while (strDate.length > 1);
            return strDate;
        };

        function sumDateTimeToDigit() {
            var arrDT = [ iYr, zeroPad(iMth), zeroPad(iDay), zeroPad(iHr), zeroPad(iMin), zeroPad(iSec) ];
            var strDateTime = arrDT.join("");
            // console.log(strDateTime, arrDT);
            do {
                var intSumDate = 0;
                for (var i = 0; i < strDateTime.length; i++) {
                    intSumDate += parseInt(strDateTime[i]);
                };
                strDateTime = intSumDate.toString();
                // console.log(intSumDate, strDateTime, strDateTime.length);
            } while (strDateTime.length > 1);
            return strDateTime;
        };

        function updateSliderAndTitle(idSlider, idTitle, valSlider) {
            document.getElementById(idSlider).value = valSlider;
            document.getElementById(idTitle).innerHTML = valSlider;
        }

        function updateAllControls() {
            updateSliderAndTitle("sliderYear", "retYear", iYr);
            updateSliderAndTitle("sliderMonth", "retMonth", iMth);
            updateSliderAndTitle("sliderDay", "retDay", iDay);
            updateSliderAndTitle("sliderHour", "retHour", iHr);
            updateSliderAndTitle("sliderMinute", "retMinute", iMin);
            updateSliderAndTitle("sliderSecond", "retSecond", iSec);

            getElm("dateTimePicker").value = `${iYr}-${zeroPad(iMth)}-${zeroPad(iDay)}T${zeroPad(iHr)}:${zeroPad(iMin)}`;

            getElm("retSingleDigit").innerHTML = sumDateTimeToDigit();

            getElm("retCurrentDateTime").innerHTML = new Date(year=iYr, month=iMth-1, date=iDay, hours=iHr, minutes=iMin, seconds=iSec);
        }
        
        function updateSliders() {
            iYr = getElm("sliderYear").value;
            iMth = getElm("sliderMonth").value;
            iDay = getElm("sliderDay").value;
            iHr = getElm("sliderHour").value;
            iMin = getElm("sliderMinute").value;
            iSec = getElm("sliderSecond").value;

            updateAllControls();
        }

        function updateDatePicker() {
            var dtVal = getElm("dateTimePicker").value;
            var dtDate = dtVal.split("T")[0].split("-");
            var dtTime = dtVal.split("T")[1].split(":");
            // console.log(dtVal, dtDate, dtTime);

            iYr = dtDate[0];
            iMth = dtDate[1];
            iDay = dtDate[2];
            iHr = dtTime[0];
            iMin = dtTime[1];
            iSec = 0;

            updateAllControls();
        }

        function initControls() {
            var sglDate = new Date();

            iYr = sglDate.getFullYear();
            iMth = sglDate.getMonth()+1;
            iDay = sglDate.getDate();
            iHr = sglDate.getHours();
            iMin = sglDate.getMinutes();
            iSec = sglDate.getSeconds();

            updateAllControls();
        }

        // Usage
        (function () {
            // console.log(sumDateToOneDigit("12042021")); // Result: 3
            initControls();
        })();

    </script>
</body>

</html>